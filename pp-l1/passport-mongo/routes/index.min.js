var express=require("express"),router=express.Router(),isAuthenticated=function(c,a,b){if(c.isAuthenticated())return b();a.redirect("/")};
module.exports=function(c){router.get("/",function(a,b){b.render("index",{message:a.flash("message")})});router.post("/login",c.authenticate("login",{successRedirect:"/home",failureRedirect:"/",failureFlash:!0}));router.get("/signup",function(a,b){b.render("register",{message:a.flash("message")})});router.post("/signup",c.authenticate("signup",{successRedirect:"/home",failureRedirect:"/signup",failureFlash:!0}));router.get("/home",isAuthenticated,function(a,b){b.render("home",{user:a.user})});router.get("/signout",
function(a,b){a.logout();b.redirect("/")});return router};
