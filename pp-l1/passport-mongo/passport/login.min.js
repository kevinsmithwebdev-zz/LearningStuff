var LocalStrategy=require("passport-local").Strategy,User=require("../models/user"),bCrypt=require("bcrypt-nodejs");module.exports=function(b){b.use("login",new LocalStrategy({passReqToCallback:!0},function(d,e,b,a){User.findOne({username:e},function(f,c){return f?a(f):c?bCrypt.compareSync(b,c.password)?a(null,c):(console.log("Invalid Password"),a(null,!1,d.flash("message","Invalid Password"))):(console.log("User Not Found with username "+e),a(null,!1,d.flash("message","User Not found.")))})}))};
